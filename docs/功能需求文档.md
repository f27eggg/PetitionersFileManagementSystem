# 功能需求文档

## 文档版本

- 版本号：v1.1
- 创建日期：2025年11月22日
- 最后更新：2025年11月22日

---

## 一、项目背景

上访人员重点监控信息管理系统旨在为管理人员提供一个高效、美观、易用的桌面应用工具，用于管理上访人员的档案信息。系统需要突出科技感和专业性，同时保持极强的可移植性，无需复杂的环境配置即可在任意Windows电脑上运行。

---

## 二、核心功能模块

### 2.1 信息展示功能

#### 2.1.1 列表展示
**功能描述**：以表格形式展示所有上访人员的核心信息

**展示字段（建议）**：
- **照片**（缩略图，40x40px）
- 姓名
- 身份证号（脱敏显示，如：110101********1234）
- 性别
- 年龄（根据身份证号计算）
- 联系方式（显示第一个）
- 赴京上访次数
- 危险等级
- 最后更新时间
- 操作按钮（查看详情/编辑/删除）

**交互要求**：
- 支持表格列排序（点击列头排序）
- 支持表格行选择（单击高亮，双击进入详情）
- 分页显示（每页20/50/100条可配置）
- 危险等级用颜色标识（绿色-低危、黄色-中危、橙色-高危、红色-极高危）
- 照片缩略图悬停放大预览

#### 2.1.2 详情展示
**功能描述**：以多标签页形式展示单个上访人员的完整档案信息

**标签页划分**：
1. **个人信息**标签页
   - **照片展示区**：左侧展示照片轮播/画廊（支持多张照片）
     - 主照片大图显示
     - 底部缩略图列表
     - 支持点击切换、放大查看
     - 提供"上传照片"、"删除照片"按钮
   - 基本信息区：姓名、身份证号、性别、籍贯、学历等
   - 联系方式区：动态列表，支持添加/删除
   - 职业与住址区：职业、工作地址、常住地址
   - 上访记录区：赴京上访次数、反侦察手段、消费习惯等

2. **在京关系人**标签页
   - 关系人信息卡片展示
   - **照片展示**：关系人照片（支持多张）
   - 支持多个关系人（未来扩展）

3. **信访案件**标签页
   - 诉求描述
   - 解决情况
   - 进京方式与轨迹

4. **评估结果**标签页
   - 危险等级（大号彩色标签）
   - 评估说明（文本描述）

**交互要求**：
- 标签页切换流畅，有动画过渡（300ms淡入淡出）
- 字段为空时显示"暂无数据"
- 提供"编辑"和"返回列表"按钮
- 照片支持全屏查看模式

---

### 2.2 信息查询功能

#### 2.2.1 快速搜索
**功能描述**：在主界面顶部提供搜索框，实时搜索

**搜索范围**：
- 姓名（模糊匹配）
- 身份证号（模糊匹配）
- 联系方式（精确匹配，支持搜索所有联系方式）

**交互要求**：
- 输入即时过滤，延迟300ms执行搜索
- 搜索结果高亮显示匹配关键词
- 显示匹配结果数量

#### 2.2.2 高级查询
**功能描述**：提供多条件组合查询功能

**查询条件**：
1. **基本条件**
   - 姓名（模糊）
   - 身份证号（模糊）
   - 性别（下拉选择）
   - 学历（下拉选择）
   - 婚姻状态（下拉选择）

2. **风险条件**
   - 危险等级（多选）
   - 赴京上访次数范围（从X次到Y次）

3. **其他条件**
   - 籍贯（模糊）
   - 进京方式（下拉选择）
   - 创建时间范围
   - 更新时间范围
   - 是否有照片（是/否/全部）

**交互要求**：
- 所有条件为"且"关系
- 提供"重置"按钮清空所有条件
- 显示查询结果数量和耗时
- 支持导出查询结果

---

### 2.3 信息录入功能

#### 2.3.1 新增人员
**功能描述**：通过表单录入新的上访人员档案

**表单布局**：
- 采用分步向导或分组表单
- 第一组：个人基本信息（必填项）
  - **照片上传区**：支持拖拽上传、点击选择文件
  - 基本字段：姓名、身份证号、性别等
- 第二组：联系方式与地址
  - **联系方式动态列表**：至少一个，可点击"+"添加更多
- 第三组：在京关系人
  - **关系人照片上传**
- 第四组：信访案件信息
- 第五组：评估结果

**字段验证**：
- 姓名：非空，2-20个字符
- 身份证号：18位，符合校验规则，检查是否重复
- 联系方式：至少一个，11位手机号或固话格式
- 赴京上访次数：非负整数
- 照片：jpg/jpeg/png/bmp格式，单张不超过5MB

**交互要求**：
- 必填项标红星标识
- 实时验证，错误提示在字段下方显示
- 提供"保存"、"保存并继续添加"、"取消"按钮
- 保存成功后给予提示并自动跳转到详情页
- 照片上传后即时显示预览

#### 2.3.2 批量导入
**功能描述**：支持从Excel/CSV文件批量导入数据

**导入流程**：
1. 选择文件（仅支持.xlsx/.csv格式）
2. 数据预览与验证
3. 错误提示（重复身份证号、格式错误等）
4. 确认导入
5. 导入结果报告（成功X条，失败Y条）

**交互要求**：
- 提供Excel模板下载
- 导入前备份现有数据
- 导入失败记录可导出为Excel查看原因
- **注意**：批量导入暂不支持照片导入，需手动补充

---

### 2.4 信息修改功能

#### 2.4.1 编辑人员信息
**功能描述**：修改已有上访人员的档案信息

**功能要求**：
- 进入编辑模式的方式：
  1. 列表页点击"编辑"按钮
  2. 详情页点击"编辑"按钮
- 编辑表单与新增表单布局一致
- 身份证号不可修改（作为唯一标识）
- 显示最后修改时间和修改人（未来扩展）
- **照片管理**：
  - 可上传新照片
  - 可删除已有照片
  - 可调整照片顺序（主照片）

**交互要求**：
- 修改前二次确认
- 提供"保存"、"取消"按钮
- 取消时询问是否放弃修改
- 删除照片时询问确认

#### 2.4.2 删除人员信息
**功能描述**：删除指定上访人员档案

**功能要求**：
- 单条删除：列表页或详情页点击"删除"
- 批量删除：列表页勾选多条记录后批量删除
- **照片同步删除**：删除人员时自动删除关联的照片文件

**交互要求**：
- 删除前二次确认，显示将要删除的人员姓名和照片数量
- 删除操作不可逆，给予明确警告
- 删除成功后给予提示并刷新列表

---

### 2.5 统计可视化功能

#### 2.5.1 仪表盘概览
**功能描述**：以可视化地图和图表形式展示数据统计信息

**界面布局**：

```
┌────────────────────────────────────────────────────────┐
│  数据卡片区（顶部）                                      │
│  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐      │
│  │ 总人数   │ │ 新增人数 │ │ 高危人员 │ │ 平均次数 │      │
│  └─────────┘ └─────────┘ └─────────┘ └─────────┘      │
├────────────────────────────────────────────────────────┤
│  ┌──────────────────────┐  ┌──────────────────────┐   │
│  │                      │  │  统计口径选择          │   │
│  │                      │  │  ○ 按危险等级分布      │   │
│  │                      │  │  ○ 按上访次数分布      │   │
│  │   中国省级行政区划    │  │  ○ 按籍贯分布          │   │
│  │   地图（主视觉）       │  │  ○ 按进京方式分布      │   │
│  │                      │  │                       │   │
│  │   [彩色高亮显示]      │  │  ┌─────────────────┐  │   │
│  │                      │  │  │  扩展统计图表     │  │   │
│  │                      │  │  │  （饼图/柱状图）  │  │   │
│  │                      │  │  │                  │  │   │
│  │                      │  │  └─────────────────┘  │   │
│  └──────────────────────┘  └──────────────────────┘   │
└────────────────────────────────────────────────────────┘
```

**统计维度**：

1. **基础统计卡片**（顶部）
   - 总人数（大号数字 + 趋势图标）
   - 本月新增人数
   - 高危人员数量（红色高亮）
   - 平均上访次数

2. **中国省级行政区划地图**（主视觉，左侧）
   - **技术方案**：使用SVG格式的中国省级地图
   - **交互功能**：
     - 鼠标悬停省份时显示该省详细数据
     - 点击省份可钻取查看该省人员列表
   - **颜色分级**：根据统计口径按数量占比显示不同颜色
     - 示例（按籍贯分布）：
       - 0人：灰色 (#30363D)
       - 1-5人：浅蓝 (#388BFD)
       - 6-10人：中蓝 (#58A6FF)
       - 11-20人：深蓝 (#1F6FEB)
       - 20+人：电子蓝高亮 (#79B8FF)
   - **数字标注**：在每个省份上显示数量标签

3. **统计口径选择器**（右侧）
   - **按危险等级分布**
     - 地图：各省危险等级人数分布
     - 扩展图表：饼图（低危/中危/高危/极高危占比）

   - **按上访次数分布**
     - 地图：各省上访次数统计
     - 扩展图表：柱状图（1次/2-3次/4-5次/6-10次/10次以上）

   - **按籍贯分布**
     - 地图：各省籍贯人数
     - 扩展图表：Top 10省份柱状图

   - **按进京方式分布**
     - 地图：各省主要进京方式
     - 扩展图表：饼图（自驾/火车/飞机/其他占比）

**交互要求**：
- 地图交互流畅，动画过渡自然（颜色渐变300ms）
- 统计口径切换时地图颜色平滑过渡
- 图表可交互（悬停显示详细数据）
- 支持地图和图表导出为图片
- 提供时间范围筛选器（筛选创建时间）
- **科技感增强**：
  - 地图边界发光效果
  - 数据变化时的动画效果
  - 卡片数字跳动动画

---

### 2.6 照片管理功能（新增）

#### 2.6.1 照片上传
**功能描述**：为上访人员和关系人上传照片

**上传方式**：
- 点击上传按钮，选择文件（支持多选）
- 拖拽文件到上传区域

**技术要求**：
- 支持格式：jpg, jpeg, png, bmp
- 单张大小限制：5MB
- 批量上传：一次最多10张
- 自动生成缩略图（用于列表展示）

**交互要求**：
- 上传进度条显示
- 上传成功后即时预览
- 上传失败给予错误提示（格式错误、大小超限等）

#### 2.6.2 照片查看
**功能描述**：查看上访人员和关系人的照片

**查看模式**：
- **缩略图模式**：列表页、详情页卡片展示
- **轮播模式**：详情页照片画廊
- **全屏模式**：点击照片放大全屏查看，支持左右切换

**交互要求**：
- 全屏查看支持ESC键退出
- 支持鼠标滚轮缩放
- 流畅的切换动画

#### 2.6.3 照片删除
**功能描述**：删除指定照片

**功能要求**：
- 单张删除：照片上显示"×"按钮
- 批量删除：勾选多张后批量删除
- 同步删除文件：删除记录的同时删除物理文件

**交互要求**：
- 删除前确认
- 至少保留一张照片（主照片）的限制提示

---

### 2.7 数据导入导出功能

#### 2.7.1 数据导出
**功能描述**：将数据导出为Excel或CSV格式

**导出方式**：
- **默认导出全部数据**（重要：这是默认行为）
- 导出当前查询结果
- 导出选中的记录

**导出格式**：
- **Excel (.xlsx)** - 包含格式和样式，推荐格式
- **CSV (.csv)** - 纯文本，兼容性好

**导出选项**：
- 是否包含脱敏处理（身份证号、联系方式）
- 是否包含照片文件（如选择，将导出为压缩包，包含Excel和photos文件夹）

**交互要求**：
- 导出前选择保存路径和文件名
- 导出进度条显示
- 导出成功后询问是否打开文件/文件夹
- 默认文件名：`上访人员数据_{日期}.xlsx`

#### 2.7.2 数据导入
（见2.3.2批量导入）

**补充说明**：
- 导入数据时不包含照片
- 照片需要单独通过编辑功能上传

---

## 三、辅助功能

### 3.1 系统设置
- 界面主题选择（深色/浅色，当前版本仅深色）
- 分页条数设置
- 数据存储路径显示（只读，确保用户知晓数据位置）
- 关于本系统（版本信息、Logo、单位信息）

### 3.2 数据备份与恢复
- 手动备份：将data目录完整打包备份（包含照片）
- 自动备份：每周自动备份（可配置）
- 数据恢复：从备份文件恢复数据和照片

---

## 四、非功能性需求

### 4.1 性能要求
- 启动时间：≤ 3秒
- 列表加载：100条数据 ≤ 500ms
- 搜索响应：≤ 300ms
- 界面切换：≤ 200ms
- **照片加载**：缩略图 ≤ 100ms，大图 ≤ 500ms
- **地图渲染**：初次加载 ≤ 1秒，交互响应 ≤ 100ms

### 4.2 易用性要求
- 操作步骤不超过3步
- 所有功能提供工具提示
- 错误提示清晰明确
- 符合Windows桌面应用操作习惯
- **照片管理**：支持拖拽上传，操作直观

### 4.3 可靠性要求
- 数据自动保存
- 异常情况下不丢失数据
- 提供数据备份机制
- **照片存储安全**：照片路径失效时给予提示，不影响其他功能

### 4.4 可移植性要求
- 单一exe文件或包含JRE的免安装包
- 无需安装额外运行环境
- **数据文件相对路径存储**（重要：包括JSON和照片）
- 整个程序目录可复制到任意电脑运行

### 4.5 视觉效果要求（新增）
- **科技感**：深色主题、霓虹色高光、发光效果
- **动画丝滑**：所有过渡动画≥60fps，使用缓动函数
- **界面简洁**：扁平化设计，信息层次清晰
- **图表美观**：使用渐变色、阴影、动画增强视觉效果

---

## 五、功能优先级

### P0（必须实现）
- 信息展示（列表+详情）
- 信息查询（快速搜索）
- 信息录入（新增）
- 信息修改（编辑+删除）
- 照片管理（上传、查看、删除）

### P1（重要功能）
- 统计可视化（仪表盘 + 地图）
- 高级查询
- 数据导出（默认全量导出）

### P2（增强功能）
- 批量导入
- 数据备份恢复
- 系统设置

---

## 六、未来扩展功能（Roadmap）

1. 用户权限管理（管理员/普通用户）
2. 操作日志记录
3. 数据变更历史追踪
4. 移动端App配套
5. 多人协同编辑
6. AI辅助风险评估
7. 地图钻取到市级/区级
8. 照片人脸识别（自动关联）

---

## 七、文档变更记录

| 版本 | 日期 | 变更内容 |
|------|------|----------|
| v1.0 | 2025-11-22 | 初始版本 |
| v1.1 | 2025-11-22 | 1. 新增照片管理功能模块（2.6）<br>2. 调整列表展示，新增照片缩略图列<br>3. 调整详情展示，新增照片画廊<br>4. 重新设计仪表盘（2.5.1），改为地图+口径选择器<br>5. 明确导出功能默认导出全部数据<br>6. 新增视觉效果要求（4.5） |

---

*文档版本：v1.1*
*创建日期：2025年11月22日*
*最后更新：2025年11月22日*
