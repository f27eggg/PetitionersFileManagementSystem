# 技术选型方案

## 文档版本

- 版本号：v1.0
- 创建日期：2025年11月
- 最后更新：2025年11月

---

## 一、技术选型原则

基于项目需求，技术选型遵循以下原则：

1. **可移植性优先**：确保程序可在任意Windows电脑上直接运行
2. **界面现代化**：支持构建科技感强、美观的桌面界面
3. **轻量级存储**：数据量小（100条以内），无需重型数据库
4. **开发效率**：选择成熟稳定的技术栈，降低开发难度
5. **维护便捷**：技术栈简单，便于后期维护和扩展

---

## 二、核心技术栈

### 2.1 开发语言：Java 17

#### 选择理由
- **长期支持版本**：JDK 17是Oracle官方LTS版本，支持周期至2029年
- **性能优化**：相比JDK 8有显著性能提升（启动速度、内存占用）
- **现代化特性**：支持Records、Text Blocks、Pattern Matching等新特性
- **内置打包工具**：自带jpackage，可直接打包成exe

#### 版本指定
```
JDK版本：17.0.12
下载地址：https://www.oracle.com/java/technologies/javase/jdk17-archive-downloads.html
```

---

### 2.2 UI框架：JavaFX

#### 选择理由

**JavaFX vs Swing对比**

| 对比维度 | JavaFX | Swing | 结论 |
|---------|--------|-------|------|
| 界面现代化 | ⭐⭐⭐⭐⭐ 支持CSS样式、动画、3D | ⭐⭐ 界面老旧 | **JavaFX胜出** |
| 科技感UI | ⭐⭐⭐⭐⭐ 易于实现炫酷效果 | ⭐ 难以实现 | **JavaFX胜出** |
| 学习曲线 | ⭐⭐⭐ 中等 | ⭐⭐⭐⭐ 传统但过时 | JavaFX更现代 |
| 性能 | ⭐⭐⭐⭐ GPU加速渲染 | ⭐⭐⭐ CPU渲染 | **JavaFX胜出** |
| 打包便捷性 | ⭐⭐⭐⭐⭐ jpackage原生支持 | ⭐⭐⭐ 需要额外工具 | **JavaFX胜出** |
| 图表支持 | ⭐⭐⭐⭐ 内置图表组件 | ⭐ 需第三方库 | **JavaFX胜出** |

**结论**：JavaFX完全满足"科技感UI"需求，是最佳选择。

#### 技术细节

**JavaFX版本**
```
JavaFX SDK: 17.0.2
Maven依赖：org.openjfx
```

**核心组件**
- **布局管理器**：BorderPane、VBox、HBox、GridPane、StackPane
- **常用控件**：TableView、TextField、ComboBox、Button、Label
- **图表组件**：PieChart、BarChart、LineChart
- **样式系统**：CSS样式表（支持深色主题定制）
- **动画系统**：FadeTransition、ScaleTransition、Timeline

---

### 2.3 数据存储：JSON文件

#### 选择理由

**数据存储方案对比**

| 方案 | 优点 | 缺点 | 适用场景 |
|------|------|------|----------|
| **JSON文件** | 轻量、无需环境、可读性强、易备份 | 不支持复杂查询、大数据量性能差 | **100条以内小数据** ✅ |
| SQLite | 嵌入式、支持SQL查询 | 需要JDBC驱动、文件不可读 | 100-10000条 |
| H2数据库 | 嵌入式、功能强大 | 配置复杂、文件不可读 | 10000+条 |
| MySQL | 功能完整 | 需要安装配置、不符合可移植性要求 | ❌ 不适用 |

**结论**：当前数据量（100条以内），JSON文件是最优选择。

#### 技术实现

**JSON处理库选择**
```
方案一：Gson（Google）
  - 优点：简单易用、性能好、文档丰富
  - Maven：com.google.code.gson:gson:2.10.1

方案二：Jackson（推荐）
  - 优点：功能强大、灵活、社区活跃
  - Maven：com.fasterxml.jackson.core:jackson-databind:2.16.0
  - 支持日期格式化、注解配置、复杂对象映射
```

**推荐使用Jackson**

**数据文件结构**
```
data/
├── petitioners.json          # 主数据文件
├── config.json               # 系统配置
└── backups/                  # 备份目录
    ├── petitioners_20251122.json
    └── petitioners_20251121.json
```

---

### 2.4 构建工具：Maven

#### 选择理由

**Maven vs Gradle对比**

| 对比维度 | Maven | Gradle |
|---------|-------|--------|
| 学习曲线 | ⭐⭐⭐⭐ 简单 | ⭐⭐ 复杂 |
| 配置方式 | XML（pom.xml）| Groovy/Kotlin DSL |
| 构建速度 | ⭐⭐⭐ | ⭐⭐⭐⭐⭐ |
| IDE集成 | ⭐⭐⭐⭐⭐ 原生支持 | ⭐⭐⭐⭐ |
| 社区成熟度 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ |

**结论**：项目简单，Maven配置清晰，更适合。

#### Maven配置要点
```xml
<properties>
    <java.version>17</java.version>
    <javafx.version>17.0.2</javafx.version>
    <jackson.version>2.16.0</jackson.version>
</properties>

<dependencies>
    <!-- JavaFX -->
    <dependency>
        <groupId>org.openjfx</groupId>
        <artifactId>javafx-controls</artifactId>
    </dependency>

    <!-- Jackson JSON -->
    <dependency>
        <groupId>com.fasterxml.jackson.core</groupId>
        <artifactId>jackson-databind</artifactId>
    </dependency>
</dependencies>
```

---

### 2.5 打包工具：jpackage

#### 选择理由

**打包方案对比**

| 方案 | 优点 | 缺点 | 可移植性 |
|------|------|------|----------|
| **jpackage** | JDK内置、支持内嵌JRE、生成原生安装包 | JDK 14+ | ⭐⭐⭐⭐⭐ |
| Launch4j | 传统方案 | 需要用户安装JRE | ⭐⭐ |
| exe4j | 商业软件 | 收费 | ⭐⭐⭐ |

**结论**：jpackage是JDK 17自带工具，可生成包含JRE的exe，完美满足可移植性需求。

#### jpackage配置
```bash
jpackage \
  --input target/ \
  --name "上访人员信息管理系统" \
  --main-jar PetitionersSystem.jar \
  --main-class com.petition.Main \
  --type exe \
  --win-shortcut \
  --win-menu \
  --icon assets/app-icon.ico \
  --app-version 1.0.0 \
  --vendor "管理系统开发组" \
  --runtime-image jre-17
```

**输出结果**
- 单一exe安装文件（约80MB，包含JRE）
- 或免安装目录包（解压即用）

---

## 三、辅助技术栈

### 3.1 图表可视化：JavaFX Charts

#### 选择理由
- JavaFX内置，无需额外依赖
- 支持饼图、柱状图、折线图、散点图
- 可自定义样式（CSS）

#### 扩展方案（可选）
如需更丰富的图表效果，可引入第三方库：
- **JFreeChart**：功能强大，但样式较传统
- **Charts (by HanSolo)**：现代化JavaFX图表库

**当前版本推荐**：使用JavaFX内置图表，满足基本需求。

---

### 3.2 地图可视化：SVG + JavaFX

#### 选择理由
- **需求**：仪表盘需要展示中国省级行政区划地图
- **SVG方案**：最适合Java FX桌面应用的地图方案

#### 技术方案对比

| 方案 | 优点 | 缺点 | 推荐度 |
|------|------|------|--------|
| **SVG + JavaFX** | 矢量无损、交互简单、性能好 | 需要SVG地图资源 | ⭐⭐⭐⭐⭐ |
| GeoJSON + Canvas | 标准格式、数据丰富 | 绘制复杂、性能一般 | ⭐⭐⭐ |
| ECharts集成 | 功能强大 | JavaFX集成困难 | ⭐⭐ |
| 在线地图API | 实时数据 | 需要网络、不符合离线要求 | ❌ |

**推荐方案：SVG + JavaFX**

#### 实现方式

1. **地图资源**
   - 使用中国省级行政区划SVG地图
   - 资源来源：开源地图库（如 china-geojson）
   - 存放位置：`assets/maps/china-provinces.svg`

2. **JavaFX加载SVG**
   ```java
   // 使用JavaFX SVGPath或第三方库
   // 方案一：SVGPath（适合简单图形）
   SVGPath province = new SVGPath();
   province.setContent("M 100,200 L 300,400...");

   // 方案二：使用第三方库（推荐）
   // org.apache.batik:batik-transcoder（SVG渲染）
   ```

3. **交互实现**
   - 鼠标悬停：setOnMouseEntered/Exited
   - 点击事件：setOnMouseClicked
   - 颜色变化：setFill(Color)
   - 工具提示：Tooltip控件

4. **数据驱动颜色**
   ```java
   // 根据数据量计算颜色
   int count = getProvinceCount("山东");
   Color color = calculateColor(count); // 分级配色
   provinceShape.setFill(color);
   ```

#### Maven依赖

```xml
<!-- SVG支持（可选，如使用复杂SVG） -->
<dependency>
    <groupId>org.apache.xmlgraphics</groupId>
    <artifactId>batik-transcoder</artifactId>
    <version>1.17</version>
</dependency>
```

#### 性能优化
- 地图SVG懒加载
- 省份Shape缓存
- 颜色计算预处理

---

### 3.3 Excel操作：Apache POI

#### 用途
- 导入Excel数据（.xlsx）
- 导出数据到Excel

#### Maven依赖
```xml
<dependency>
    <groupId>org.apache.poi</groupId>
    <artifactId>poi-ooxml</artifactId>
    <version>5.2.5</version>
</dependency>
```

---

### 3.4 日志框架：SLF4J + Logback

#### 用途
- 记录系统运行日志
- 错误追踪与调试

#### Maven依赖
```xml
<dependency>
    <groupId>ch.qos.logback</groupId>
    <artifactId>logback-classic</artifactId>
    <version>1.4.14</version>
</dependency>
```

---

## 四、项目架构设计

### 4.1 分层架构

```
┌─────────────────────────────────────────┐
│         UI Layer (JavaFX)               │
│  - FXML视图文件                          │
│  - Controller控制器                      │
│  - CSS样式文件                           │
└─────────────────┬───────────────────────┘
                  │
┌─────────────────▼───────────────────────┐
│      Service Layer (业务逻辑层)          │
│  - PetitionerService                    │
│  - QueryService                         │
│  - ExportService                        │
│  - StatisticsService                    │
└─────────────────┬───────────────────────┘
                  │
┌─────────────────▼───────────────────────┐
│       DAO Layer (数据访问层)             │
│  - JsonDataManager                      │
│  - BackupManager                        │
└─────────────────┬───────────────────────┘
                  │
┌─────────────────▼───────────────────────┐
│       Model Layer (数据模型层)           │
│  - Petitioner                           │
│  - PersonalInfo                         │
│  - BeijingContact                       │
│  - PetitionCase                         │
│  - RiskAssessment                       │
└─────────────────────────────────────────┘
```

### 4.2 设计模式应用

| 设计模式 | 应用场景 |
|---------|----------|
| **单例模式** | 数据管理器、配置管理器 |
| **MVC模式** | UI层采用FXML+Controller |
| **工厂模式** | 图表对象创建 |
| **观察者模式** | 数据变更通知界面刷新 |

---

## 五、开发工具推荐

### 5.1 IDE
- **IntelliJ IDEA Ultimate**（推荐）
  - 完美支持JavaFX开发
  - 内置Scene Builder集成
  - 强大的Maven支持

- **Eclipse + e(fx)clipse插件**（备选）

### 5.2 UI设计工具
- **Scene Builder**：JavaFX可视化界面设计工具
  - 拖拽式设计
  - 生成FXML文件
  - 下载地址：https://gluonhq.com/products/scene-builder/

### 5.3 图标与素材
- **阿里巴巴矢量图标库**：https://www.iconfont.cn/
- **Flaticon**：https://www.flaticon.com/

---

## 六、技术栈总结

| 技术分类 | 选型 | 版本 |
|---------|------|------|
| **开发语言** | Java | 17.0.12 |
| **UI框架** | JavaFX | 17.0.2 |
| **数据存储** | JSON文件 | - |
| **JSON库** | Jackson | 2.16.0 |
| **构建工具** | Maven | 3.9+ |
| **打包工具** | jpackage | JDK 17内置 |
| **Excel处理** | Apache POI | 5.2.5 |
| **日志框架** | Logback | 1.4.14 |
| **图表库** | JavaFX Charts | 内置 |

---

## 七、可行性分析

### 7.1 技术风险评估

| 风险项 | 风险等级 | 应对措施 |
|--------|---------|----------|
| JavaFX学习曲线 | 🟡 中 | 参考官方文档和开源项目 |
| JSON文件性能瓶颈 | 🟢 低 | 100条数据不构成性能问题 |
| jpackage打包兼容性 | 🟢 低 | JDK 17成熟方案 |
| 深色主题实现难度 | 🟢 低 | CSS完全支持 |
| SVG地图加载性能 | 🟢 低 | 省级地图元素少，性能无压力 |
| 照片文件管理 | 🟡 中 | 使用相对路径，完善文件校验 |

### 7.2 技术可行性结论

✅ **完全可行**

所选技术栈成熟稳定，完全满足项目需求：
- ✅ 可移植性：jpackage内嵌JRE + 相对路径存储
- ✅ 科技感UI：JavaFX + CSS + SVG地图
- ✅ 轻量存储：JSON文件 + 照片文件夹
- ✅ 开发效率：成熟工具链
- ✅ 地图可视化：SVG + JavaFX原生支持

---

## 八、技术栈总结（更新）

| 技术分类 | 选型 | 版本 | 用途 |
|---------|------|------|------|
| **开发语言** | Java | 17.0.12 | 核心语言 |
| **UI框架** | JavaFX | 17.0.2 | 界面框架 |
| **数据存储** | JSON文件 | - | 结构化数据 |
| **JSON库** | Jackson | 2.16.0 | JSON序列化 |
| **构建工具** | Maven | 3.9+ | 项目构建 |
| **打包工具** | jpackage | JDK 17内置 | exe打包 |
| **Excel处理** | Apache POI | 5.2.5 | 导入导出 |
| **日志框架** | Logback | 1.4.14 | 日志记录 |
| **图表库** | JavaFX Charts | 内置 | 饼图/柱状图 |
| **地图可视化** | SVG + JavaFX | - | 中国地图 |
| **SVG支持** | Apache Batik | 1.17 | SVG渲染（可选） |

---

*文档版本：v1.1*
*创建日期：2025年11月22日*
*最后更新：2025年11月22日*

## 文档变更记录

| 版本 | 日期 | 变更内容 |
|------|------|----------|
| v1.0 | 2025-11-22 | 初始版本 |
| v1.1 | 2025-11-22 | 1. 新增地图可视化技术选型（SVG + JavaFX）<br>2. 更新技术栈总结表<br>3. 新增照片文件管理风险评估<br>4. 补充Maven依赖配置 |
